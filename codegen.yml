overwrite: true

hooks:
  afterAllFileWrite:
    - prettier --write

schema: packages/server/src/graphql/**/*.graphql

documents: packages/web/src/**/*.graphql

generates:
  packages/server/src/graphql/resolvers-types.generated.ts:
    config:
      mapperTypeSuffix: Entity
      mappers:
        Author: ../database/entity#Author
        Avatar: ../database/entity#Avatar
        Book: ../database/entity#Book
        BookCopy: ../database/entity#BookCopy
        User: ../database/entity#User
        CurrentUser: ../database/entity#User
      showUnusedMappers: true
      scalars:
        ExternalID: string
    plugins:
      - typescript
      - typescript-resolvers

  packages/fake-server/src/schema.generated.json:
    plugins:
      - introspection

  packages/web/src/schema.generated.json:
    plugins:
      - introspection

  packages/web/src/introspectionResult.generated.ts:
    plugins:
      - fragment-matcher
    config:
      apolloClientVersion: 3

  packages/web/src/types.generated.ts:
    plugins:
      - typescript

  packages/web/src:
    plugins:
      - typescript-operations
      - typescript-react-apollo
    preset: near-operation-file
    presetConfig:
      extension: .generated.tsx
      baseTypesPath: types.generated.ts
    config:
      gqlImport: "@apollo/client#gql"
      reactApolloVersion: 3
      withHooks: true
      withComponent: false
      withHOC: false
